<html>
<head>
  <title>js-diagram-to-img</title>
  <link href="vendor/normalize.css/normalize.css" media="screen" rel="stylesheet" type="text/css">
</head>
<body>
  <div>
    <svg viewBox="0 0 500 100" class="chart" width="452" height="180" id="svg">
      <polyline
         fill="none"
         stroke="#0074d9"
         stroke-width="2"
         points="
           00,120
           20,60
           40,80
           60,20
           80,80
           100,80
           120,60
           140,100
           160,90
           180,80
           200, 110
           220, 10
           240, 70
           260, 100
           280, 100
           300, 40
           320, 0
           340, 100
           360, 100
           380, 120
           400, 60
           420, 70
           440, 80
         "
       />
    </svg>
    <div id="background"></div>
    <div>
      <div>
        <textarea id="input" style="width: 400px; height: 200px;"></textarea>
        <div><input type="submit" id="encode" value="encode"></div>
      </div>
      <div>
        <textarea id="output" style="width: 400px; height: 200px;"></textarea>
        <div><input type="submit" id="apply" value="apply"></div>
      </div>
    </div>
    <div>
      <img src="" id="img">
    </div>
  </div>
  <style type="text/css">
    #background {
      width: 452px;
      height: 180px;
      background: url('data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgNTAwIDEwMCIgY2xhc3M9ImNoYXJ0IiB3aWR0aD0iNDUyIiBoZWlnaHQ9IjE4MCIgaWQ9InN2ZyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KICAgICAgPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwNzRkOSIgc3Ryb2tlLXdpZHRoPSIyIiBwb2ludHM9Ig0KICAgICAgICAgICAwMCwxMjANCiAgICAgICAgICAgMjAsNjANCiAgICAgICAgICAgNDAsODANCiAgICAgICAgICAgNjAsMjANCiAgICAgICAgICAgODAsODANCiAgICAgICAgICAgMTAwLDgwDQogICAgICAgICAgIDEyMCw2MA0KICAgICAgICAgICAxNDAsMTAwDQogICAgICAgICAgIDE2MCw5MA0KICAgICAgICAgICAxODAsODANCiAgICAgICAgICAgMjAwLCAxMTANCiAgICAgICAgICAgMjIwLCAxMA0KICAgICAgICAgICAyNDAsIDcwDQogICAgICAgICAgIDI2MCwgMTAwDQogICAgICAgICAgIDI4MCwgMTAwDQogICAgICAgICAgIDMwMCwgNDANCiAgICAgICAgICAgMzIwLCAwDQogICAgICAgICAgIDM0MCwgMTAwDQogICAgICAgICAgIDM2MCwgMTAwDQogICAgICAgICAgIDM4MCwgMTIwDQogICAgICAgICAgIDQwMCwgNjANCiAgICAgICAgICAgNDIwLCA3MA0KICAgICAgICAgICA0NDAsIDgwDQogICAgICAgICAiPjwvcG9seWxpbmU+DQogICAgPC9zdmc+');
    }
  </style>
  <script src="vendor/jquery/jquery.slim.min.js" charset="utf-8"></script>
  <script src="https://rawgithub.com/yatt/jquery.base64/master/jquery.base64.js" charset="utf-8"></script>
  <script>

    $('input[type=submit]#encode').on('click', function() {
      var text = $('textarea#input').val();
      var blob = $.base64.encode(text);
      $('textarea#output').val(blob);
    });
    $('input[type=submit]#apply').on('click', function() {
      var blob = $('textarea#output').val();
      $('#img').attr('src', 'data:image/svg+xml;base64,' + blob);
    })

  </script>
</body>
</html>
